<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Draggable Handle Button for Table Rows</title>
<style>
  /* قم بتخصيص النمط حسب الحاجة */
  table {
    border-collapse: collapse;
    width: 100%;
  }

  th, td {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
  }

  th {
    background-color: #f2f2f2;
  }

  .drag-handle {
    cursor: grab;
  }
</style>
</head>
<body>

<table id="myTable">
  <thead>
    <tr>
      <th>Header 1</th>
      <th>Header 2</th>
      <th>Header 3</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Row 1 Data 1</td>
      <td>Row 1 Data 2</td>
      <td>Row 1 Data 3</td>
      <td><button class="drag-handle">Drag</button></td>
    </tr>
    <tr>
      <td>Row 2 Data 1</td>
      <td>Row 2 Data 2</td>
      <td>Row 2 Data 3</td>
      <td><button class="drag-handle">Drag</button></td>
    </tr>
    <!-- الصفوف الأخرى هنا -->
  </tbody>
</table>

<script>
  function makeTableRowsDraggable(tableId) {
    const table = document.getElementById(tableId).getElementsByTagName('tbody')[0];
    let draggedRow = null;

    table.addEventListener('mousedown', function(event) {
      if (event.target.classList.contains('drag-handle')) {
        draggedRow = event.target.closest('tr');
        draggedRow.style.cursor = 'grabbing';
        const mouseY = event.clientY;
        const initialTop = draggedRow.getBoundingClientRect().top;
        
        const mouseMoveHandler = function(event) {
          const deltaY = event.clientY - mouseY;
          draggedRow.style.transform = `translateY(${deltaY}px)`;
        };

        const mouseUpHandler = function(event) {
          document.removeEventListener('mousemove', mouseMoveHandler);
          document.removeEventListener('mouseup', mouseUpHandler);
          draggedRow.style.cursor = 'grab';
          draggedRow.style.transform = '';
          const targetRow = document.elementFromPoint(event.clientX, event.clientY).closest('tr');
          if (targetRow !== draggedRow) {
            const rows = Array.from(table.children);
            const indexDragged = rows.indexOf(draggedRow);
            const indexTarget = rows.indexOf(targetRow);
            if (indexTarget > indexDragged) {
              table.insertBefore(draggedRow, targetRow.nextSibling);
            } else {
              table.insertBefore(draggedRow, targetRow);
            }
          }
          draggedRow = null;
        };

        document.addEventListener('mousemove', mouseMoveHandler);
        document.addEventListener('mouseup', mouseUpHandler);
      }
    });

    table.addEventListener('dragstart', function(event) {
      event.preventDefault();
    });
  }

  // استدعاء الدالة وتمرير اسم الجدول كمعلمة
  makeTableRowsDraggable('myTable');
</script>

</body>
</html>
